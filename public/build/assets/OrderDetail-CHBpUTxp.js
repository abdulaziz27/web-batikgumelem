import{r as o,j as e,L as E,$ as u}from"./app-YnomA18Q.js";import{B as x}from"./index-D5ypImlc.js";import{C as r,a as c,b as l,c as d,e as T}from"./card-GOltS1pr.js";import{S as B}from"./separator-C2IUOv2T.js";import{A}from"./app-layout-6rHw8Fyz.js";import{a as m}from"./formatters-NwLEpD3y.js";import{A as I}from"./arrow-left-DgLhXwOn.js";import{L as M}from"./loader-circle-DICy9xyH.js";import{C as b}from"./credit-card-B9k0mA-A.js";import{C as v}from"./Combination-Ch6bljDX.js";import{C as w}from"./clock-CoP42yND.js";import{X as R}from"./use-initials-DVWZZxB2.js";import{S as z}from"./shopping-bag-Cr7kBFK1.js";import{P as F}from"./package-Cp7jpxZG.js";/* empty css            */import"./app-sidebar-header-S4rVPHw0.js";import"./app-logo-icon-Bg2Vq9KS.js";import"./breadcrumb-C2iYSasT.js";import"./index-DrcDnigx.js";import"./map-pin-DL50tCOn.js";function ce({order:s}){var f,y;const[p,h]=o.useState(null),[g,n]=o.useState(!1);o.useEffect(()=>{if(s.payment_url)try{const a=JSON.parse(s.payment_url);if(a.token)h(a.token);else{const t=s.payment_url.match(/([^\/]+)$/);t&&t[1]&&h(t[1])}}catch{const t=s.payment_url.match(/([^\/]+)$/);t&&t[1]&&h(t[1])}},[s.payment_url]),o.useEffect(()=>{const a=document.getElementById("midtrans-script");a&&document.body.removeChild(a);const t="https://app.sandbox.midtrans.com/snap/snap.js",i=document.createElement("script");return i.id="midtrans-script",i.src=t,i.setAttribute("data-client-key","SB-Mid-client-xo3JszBk1gen0AEn"),i.onload=()=>{console.log("Snap.js loaded successfully")},i.onerror=()=>{console.error("Failed to load Snap.js")},document.body.appendChild(i),()=>{const N=document.getElementById("midtrans-script");N&&document.body.removeChild(N)}},[]);const k=()=>{n(!0),window.snap&&p?(console.log("Opening Snap payment modal with token:",p),window.snap.pay(p,{onSuccess:function(a){console.log("Payment success:",a),setTimeout(()=>{j(s.id)},1500)},onPending:function(a){console.log("Payment pending:",a),setTimeout(()=>{j(s.id)},1500)},onError:function(a){console.error("Payment error:",a),n(!1)},onClose:function(){console.log("Payment widget closed"),n(!1)}})):(console.error("Snap.js not loaded or token not available"),s.payment_url&&(window.location.href=s.payment_url),n(!1))},j=a=>{fetch(`/checkout/check-status/${a}`).then(t=>{t.ok?window.location.reload():(console.error("Failed to check payment status"),n(!1))}).catch(t=>{console.error("Error checking payment status:",t),n(!1)})},_=[{title:"Dashboard",href:"/dashboard"},{title:"Pesanan Saya",href:"/orders"},{title:`Pesanan #${s.order_number}`,href:`/orders/${s.id}`}],C=a=>{const t={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(a).toLocaleDateString("id-ID",t)},S=a=>{switch(a.toLowerCase()){case"pending":return"text-orange-500 bg-orange-50";case"processing":return"text-blue-500 bg-blue-50";case"shipped":return"text-purple-500 bg-purple-50";case"completed":return"text-green-500 bg-green-50";case"cancelled":return"text-red-500 bg-red-50";default:return"text-gray-500 bg-gray-50"}},P=a=>{switch(a.toLowerCase()){case"pending":return e.jsx(w,{className:"h-4 w-4"});case"processing":return e.jsx(F,{className:"h-4 w-4"});case"shipped":return e.jsx(z,{className:"h-4 w-4"});case"completed":return e.jsx(v,{className:"h-4 w-4"});case"cancelled":return e.jsx(R,{className:"h-4 w-4"});default:return e.jsx(w,{className:"h-4 w-4"})}},L=a=>{switch(a.toLowerCase()){case"pending":return"Menunggu";case"processing":return"Diproses";case"shipped":return"Dikirim";case"completed":return"Selesai";case"cancelled":return"Dibatalkan";default:return a}},D=a=>{switch(a.toLowerCase()){case"paid":return"text-green-500 bg-green-50";case"pending":return"text-orange-500 bg-orange-50";case"failed":return"text-red-500 bg-red-50";default:return"text-gray-500 bg-gray-50"}},$=a=>{switch(a.toLowerCase()){case"paid":return"Dibayar";case"pending":return"Menunggu Pembayaran";case"failed":return"Gagal";default:return a}};return console.log(s),e.jsxs(A,{breadcrumbs:_,children:[e.jsx(E,{title:`Pesanan #${s.order_number}`}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex flex-col space-y-2 md:flex-row md:items-center md:justify-between md:space-y-0",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold tracking-tight",children:["Detail Pesanan #",s.order_number]}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Tanggal pemesanan: ",C(s.created_at)]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(x,{asChild:!0,variant:"outline",children:e.jsxs(u,{href:"/orders",children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Kembali ke Daftar Pesanan"]})}),s.payment_status!=="paid"&&s.payment_url&&s.status!=="cancelled"&&e.jsx(x,{onClick:k,className:"bg-green-600 hover:bg-green-700",disabled:g,children:g?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"mr-2 h-4 w-4 animate-spin"}),"Memproses..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),"Bayar Sekarang"]})}),s.status==="shipped"&&e.jsxs(u,{href:`/orders/${s.id}/complete`,method:"put",className:"inline-flex items-center justify-center rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white shadow hover:bg-green-700",children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Konfirmasi Terima Pesanan"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(r,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(l,{className:"text-sm font-medium",children:"Status Pesanan"})}),e.jsxs(d,{children:[e.jsxs("div",{className:`inline-flex items-center space-x-1 rounded-full px-2.5 py-1 text-sm ${S(s.status)}`,children:[P(s.status),e.jsx("span",{children:L(s.status)})]}),s.tracking_number&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("div",{className:"font-medium",children:"Nomor Resi:"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:s.tracking_number}),s.tracking_url&&e.jsx(x,{asChild:!0,variant:"link",size:"sm",className:"h-auto p-0",children:e.jsx("a",{href:s.tracking_url,target:"_blank",rel:"noopener noreferrer",children:"Lacak"})})]})]})]})]}),e.jsxs(r,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(l,{className:"text-sm font-medium",children:"Status Pembayaran"})}),e.jsxs(d,{children:[e.jsxs("div",{className:`inline-flex items-center space-x-1 rounded-full px-2.5 py-1 text-sm ${D(s.payment_status)}`,children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{children:$(s.payment_status)})]}),e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("div",{className:"font-medium",children:"Metode Pembayaran:"}),e.jsx("div",{children:s.payment_method==="bank_transfer"?"Transfer Bank":"E-Wallet"})]})]})]}),e.jsxs(r,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(l,{className:"text-sm font-medium",children:"Pengiriman"})}),e.jsx(d,{children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"font-medium",children:[((f=s.shipping_method)==null?void 0:f.company)||"JNE"," - ",((y=s.shipping_method)==null?void 0:y.name)||"Reguler"]}),e.jsxs("div",{className:"text-muted-foreground",children:["Biaya: ",m(s.shipping_cost)]})]})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs(r,{children:[e.jsxs(c,{children:[e.jsx(l,{children:"Item Pesanan"}),e.jsxs(T,{children:[s.items.length," item dalam pesanan ini"]})]}),e.jsxs(d,{children:[e.jsx("div",{className:"space-y-4",children:s.items.map(a=>e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"h-20 w-20 flex-shrink-0 overflow-hidden rounded-md border",children:e.jsx("img",{src:a.product.image?`/storage/${a.product.image}`:"/images/placeholder.png",alt:a.product.name,className:"h-full w-full object-cover object-center"})}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("h3",{className:"font-medium",children:e.jsx(u,{className:"hover:underline",href:`/products/${a.product.slug}`,children:a.product.name})}),a.size&&e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Ukuran: ",a.size]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm",children:[a.quantity," x ",m(a.price)]}),e.jsx("span",{className:"font-medium",children:m(a.quantity*a.price)})]})]})]},a.id))}),s.notes&&e.jsxs("div",{className:"mt-6 rounded-lg border p-3",children:[e.jsx("h4",{className:"font-medium",children:"Catatan Saya:"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:s.notes})]}),s.admin_notes&&e.jsxs("div",{className:"mt-6 rounded-lg border bg-blue-50 p-3",children:[e.jsx("h4",{className:"font-medium",children:"Catatan dari Admin:"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:s.admin_notes})]}),s.status==="shipped"&&e.jsxs("div",{className:"mt-6 rounded-lg border bg-yellow-50 p-3",children:[e.jsx("h4",{className:"font-medium",children:"Informasi:"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Harap konfirmasi penerimaan pesanan setelah barang diterima. Jika tidak ada konfirmasi dalam 7 hari setelah pengiriman, pesanan akan otomatis dianggap selesai."})]})]})]})}),e.jsxs("div",{children:[e.jsxs(r,{children:[e.jsx(c,{children:e.jsx(l,{children:"Ringkasan Pesanan"})}),e.jsx(d,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:m(s.total_price)})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Ongkos Kirim"}),e.jsx("span",{children:m(s.shipping_cost)})]})]}),e.jsx(B,{}),e.jsxs("div",{className:"flex items-center justify-between font-medium",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:m(s.total_amount)})]})]})})]}),e.jsxs(r,{className:"mt-4",children:[e.jsx(c,{children:e.jsx(l,{children:"Alamat Pengiriman"})}),e.jsx(d,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("div",{className:"font-medium",children:s.shipping_address.full_name}),e.jsx("div",{className:"text-muted-foreground",children:s.shipping_address.phone}),e.jsxs("div",{className:"text-muted-foreground",children:[s.shipping_address.address,", ",s.shipping_address.city,",",e.jsx("br",{}),s.shipping_address.province,", ",s.shipping_address.postal_code]})]})})]})]})]})]})]})}export{ce as default};
