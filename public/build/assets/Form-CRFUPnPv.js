import{r as o,j as t,t as ne,L as ae,$ as U,S as W}from"./app-BXt1EXhE.js";import{c as oe,a as V,B as N,I as k}from"./index-CYkK3APA.js";import{C as ce,a as le,b as de,c as ue,d as me}from"./card-BPxOS1W-.js";import{L as C}from"./label-Dnq04W0N.js";import{S as fe}from"./separator-xWZELdkL.js";import{T as pe}from"./textarea-BzzmMTWt.js";import{A as he}from"./admin-layout-CQJqhwwW.js";import{A as ge}from"./arrow-left-DTggvRu7.js";import{X as xe}from"./use-initials-4Cu_RISo.js";import{P as ve}from"./plus-DUC4uCvH.js";import{M as ye}from"./minus-B4XNXIjG.js";import{S as be}from"./save-CN2UK_tq.js";/* empty css            */import"./app-sidebar-header-CxhEH_Nu.js";import"./app-logo-icon-CIOCRvVq.js";import"./breadcrumb-CQM-6EPa.js";import"./Combination-l0fbbUhy.js";import"./index-D2yaAqYb.js";import"./package-DLSA3Cxw.js";import"./pencil-BPFbZDP2.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],Se=oe("Upload",je);function we(e,s,{checkForDefaultPrevented:a=!0}={}){return function(i){if(e==null||e(i),a===!1||!i.defaultPrevented)return s==null?void 0:s(i)}}function q(e,s){if(typeof e=="function")return e(s);e!=null&&(e.current=s)}function Ce(...e){return s=>{let a=!1;const c=e.map(i=>{const d=q(i,s);return!a&&typeof d=="function"&&(a=!0),d});if(a)return()=>{for(let i=0;i<c.length;i++){const d=c[i];typeof d=="function"?d():q(e[i],null)}}}}function F(...e){return o.useCallback(Ce(...e),e)}function _e(e,s=[]){let a=[];function c(d,u){const l=o.createContext(u),p=a.length;a=[...a,u];const m=f=>{var _;const{scope:x,children:j,...y}=f,S=((_=x==null?void 0:x[e])==null?void 0:_[p])||l,P=o.useMemo(()=>y,Object.values(y));return t.jsx(S.Provider,{value:P,children:j})};m.displayName=d+"Provider";function h(f,x){var S;const j=((S=x==null?void 0:x[e])==null?void 0:S[p])||l,y=o.useContext(j);if(y)return y;if(u!==void 0)return u;throw new Error(`\`${f}\` must be used within \`${d}\``)}return[m,h]}const i=()=>{const d=a.map(u=>o.createContext(u));return function(l){const p=(l==null?void 0:l[e])||d;return o.useMemo(()=>({[`__scope${e}`]:{...l,[e]:p}}),[l,p])}};return i.scopeName=e,[c,Ne(i,...s)]}function Ne(...e){const s=e[0];if(e.length===1)return s;const a=()=>{const c=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(d){const u=c.reduce((l,{useScope:p,scopeName:m})=>{const f=p(d)[`__scope${m}`];return{...l,...f}},{});return o.useMemo(()=>({[`__scope${s.scopeName}`]:u}),[u])}};return a.scopeName=s.scopeName,a}var H=globalThis!=null&&globalThis.document?o.useLayoutEffect:()=>{},ke=ne[" useInsertionEffect ".trim().toString()]||H;function Pe({prop:e,defaultProp:s,onChange:a=()=>{},caller:c}){const[i,d,u]=ze({defaultProp:s,onChange:a}),l=e!==void 0,p=l?e:i;{const h=o.useRef(e!==void 0);o.useEffect(()=>{const f=h.current;f!==l&&console.warn(`${c} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=l},[l,c])}const m=o.useCallback(h=>{var f;if(l){const x=Ee(h)?h(e):h;x!==e&&((f=u.current)==null||f.call(u,x))}else d(h)},[l,e,d,u]);return[p,m]}function ze({defaultProp:e,onChange:s}){const[a,c]=o.useState(e),i=o.useRef(a),d=o.useRef(s);return ke(()=>{d.current=s},[s]),o.useEffect(()=>{var u;i.current!==a&&((u=d.current)==null||u.call(d,a),i.current=a)},[a,i]),[a,c,d]}function Ee(e){return typeof e=="function"}function Ie(e){const s=o.useRef({value:e,previous:e});return o.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}function Re(e){const[s,a]=o.useState(void 0);return H(()=>{if(e){a({width:e.offsetWidth,height:e.offsetHeight});const c=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const d=i[0];let u,l;if("borderBoxSize"in d){const p=d.borderBoxSize,m=Array.isArray(p)?p[0]:p;u=m.inlineSize,l=m.blockSize}else u=e.offsetWidth,l=e.offsetHeight;a({width:u,height:l})});return c.observe(e,{box:"border-box"}),()=>c.unobserve(e)}else a(void 0)},[e]),s}function $e(e){const s=Fe(e),a=o.forwardRef((c,i)=>{const{children:d,...u}=c,l=o.Children.toArray(d),p=l.find(De);if(p){const m=p.props.children,h=l.map(f=>f===p?o.Children.count(m)>1?o.Children.only(null):o.isValidElement(m)?m.props.children:null:f);return t.jsx(s,{...u,ref:i,children:o.isValidElement(m)?o.cloneElement(m,void 0,h):null})}return t.jsx(s,{...u,ref:i,children:d})});return a.displayName=`${e}.Slot`,a}function Fe(e){const s=o.forwardRef((a,c)=>{const{children:i,...d}=a,u=o.isValidElement(i)?Le(i):void 0,l=F(u,c);if(o.isValidElement(i)){const p=Be(d,i.props);return i.type!==o.Fragment&&(p.ref=l),o.cloneElement(i,p)}return o.Children.count(i)>1?o.Children.only(null):null});return s.displayName=`${e}.SlotClone`,s}var Ae=Symbol("radix.slottable");function De(e){return o.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Ae}function Be(e,s){const a={...s};for(const c in s){const i=e[c],d=s[c];/^on[A-Z]/.test(c)?i&&d?a[c]=(...l)=>{const p=d(...l);return i(...l),p}:i&&(a[c]=i):c==="style"?a[c]={...i,...d}:c==="className"&&(a[c]=[i,d].filter(Boolean).join(" "))}return{...e,...a}}function Le(e){var c,i;let s=(c=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:c.get,a=s&&"isReactWarning"in s&&s.isReactWarning;return a?e.ref:(s=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,a=s&&"isReactWarning"in s&&s.isReactWarning,a?e.props.ref:e.props.ref||e.ref)}var Te=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],X=Te.reduce((e,s)=>{const a=$e(`Primitive.${s}`),c=o.forwardRef((i,d)=>{const{asChild:u,...l}=i,p=u?a:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),t.jsx(p,{...l,ref:d})});return c.displayName=`Primitive.${s}`,{...e,[s]:c}},{}),I="Switch",[Me,ut]=_e(I),[Oe,Ue]=Me(I),G=o.forwardRef((e,s)=>{const{__scopeSwitch:a,name:c,checked:i,defaultChecked:d,required:u,disabled:l,value:p="on",onCheckedChange:m,form:h,...f}=e,[x,j]=o.useState(null),y=F(s,z=>j(z)),S=o.useRef(!1),P=x?h||!!x.closest("form"):!0,[_,R]=Pe({prop:i,defaultProp:d??!1,onChange:m,caller:I});return t.jsxs(Oe,{scope:a,checked:_,disabled:l,children:[t.jsx(X.button,{type:"button",role:"switch","aria-checked":_,"aria-required":u,"data-state":Q(_),"data-disabled":l?"":void 0,disabled:l,value:p,...f,ref:y,onClick:we(e.onClick,z=>{R($=>!$),P&&(S.current=z.isPropagationStopped(),S.current||z.stopPropagation())})}),P&&t.jsx(K,{control:x,bubbles:!S.current,name:c,value:p,checked:_,required:u,disabled:l,form:h,style:{transform:"translateX(-100%)"}})]})});G.displayName=I;var Z="SwitchThumb",J=o.forwardRef((e,s)=>{const{__scopeSwitch:a,...c}=e,i=Ue(Z,a);return t.jsx(X.span,{"data-state":Q(i.checked),"data-disabled":i.disabled?"":void 0,...c,ref:s})});J.displayName=Z;var We="SwitchBubbleInput",K=o.forwardRef(({__scopeSwitch:e,control:s,checked:a,bubbles:c=!0,...i},d)=>{const u=o.useRef(null),l=F(u,d),p=Ie(a),m=Re(s);return o.useEffect(()=>{const h=u.current;if(!h)return;const f=window.HTMLInputElement.prototype,j=Object.getOwnPropertyDescriptor(f,"checked").set;if(p!==a&&j){const y=new Event("click",{bubbles:c});j.call(h,a),h.dispatchEvent(y)}},[p,a,c]),t.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...i,tabIndex:-1,ref:l,style:{...i.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});K.displayName=We;function Q(e){return e?"checked":"unchecked"}var Y=G,Ve=J;const ee=o.forwardRef(({className:e,...s},a)=>t.jsx(Y,{className:V("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...s,ref:a,children:t.jsx(Ve,{className:V("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));ee.displayName=Y.displayName;function mt({product:e,isEdit:s=!1}){var D,B,L,T;const a=((D=e==null?void 0:e.images)==null?void 0:D.map(r=>({id:r.id,url:r.image_url||`/storage/${r.image}`,is_primary:r.is_primary,is_new:!1})))||[],[c,i]=o.useState(a),[d,u]=o.useState([]),[l,p]=o.useState(((L=(B=e==null?void 0:e.images)==null?void 0:B.find(r=>r.is_primary))==null?void 0:L.id)||null),[m,h]=o.useState({name:(e==null?void 0:e.name)||"",slug:(e==null?void 0:e.slug)||"",description:(e==null?void 0:e.description)||"",price:(e==null?void 0:e.price)||0,stock:(e==null?void 0:e.stock)||0,is_active:(e==null?void 0:e.is_active)??!0,sizes:((T=e==null?void 0:e.sizes)==null?void 0:T.map(r=>({id:r.id,size:r.size,stock:r.stock})))||[{size:"",stock:0}],deleted_image_ids:[],primary_image_id:l,new_images:[]}),[f,x]=o.useState({}),[j,y]=o.useState(!1);o.useEffect(()=>{h(r=>({...r,deleted_image_ids:d}))},[d]),o.useEffect(()=>{h(r=>({...r,primary_image_id:l}))},[l]),o.useEffect(()=>{const r=c.filter(n=>n.is_new&&n.file).map(n=>n.file);h(n=>({...n,new_images:r}))},[c]);const S=[{title:"Dashboard",href:"/admin/dashboard"},{title:"Products",href:"/admin/products"},{title:s?"Edit Product":"Create Product",href:s?`/admin/products/${e==null?void 0:e.id}/edit`:"/admin/products/create"}],P=r=>{const n=r.target.files;if(!n||n.length===0)return;const v=Array.from(n),b=[];v.forEach(g=>{const w=new FileReader;w.onload=M=>{var O;if((O=M.target)!=null&&O.result){const re={url:M.target.result,is_primary:c.length===0&&b.length===0,is_new:!0,file:g};i(ie=>[...ie,re])}},w.readAsDataURL(g)}),r.target.value=""},_=r=>{const n=c[r];n.id&&!n.is_new&&(u(v=>[...v,n.id]),l===n.id&&p(null)),i(v=>v.filter((b,g)=>g!==r))},R=r=>{const n=c[r];i(v=>v.map((b,g)=>({...b,is_primary:g===r}))),n.id&&!n.is_new?p(n.id):p(null)},z=()=>{if(typeof m.name=="string"){const r=m.name.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-");h(n=>({...n,slug:r}))}},$=()=>{h(r=>({...r,sizes:[...r.sizes,{size:"",stock:0}]}))},te=r=>{h(n=>({...n,sizes:n.sizes.filter((v,b)=>b!==r)}))},A=(r,n,v)=>{h(b=>{const g=[...b.sizes];return g[r]={...g[r],[n]:v},{...b,sizes:g}})},se=r=>{r.preventDefault(),y(!0);const n=new FormData;n.append("name",m.name),n.append("slug",m.slug),n.append("description",m.description),n.append("price",m.price.toString()),n.append("stock",m.stock.toString()),n.append("is_active",m.is_active?"1":"0"),m.sizes.forEach((g,w)=>{g.id&&n.append(`sizes[${w}][id]`,g.id.toString()),n.append(`sizes[${w}][size]`,g.size),n.append(`sizes[${w}][stock]`,g.stock.toString())}),d.forEach((g,w)=>{n.append(`deleted_image_ids[${w}]`,g.toString())}),l!==null&&n.append("primary_image_id",l.toString()),c.filter(g=>g.is_new&&g.file).map(g=>g.file).forEach((g,w)=>{n.append(`new_images[${w}]`,g)});const b={preserveScroll:!0,preserveState:!0,onSuccess:()=>{y(!1),x({})},onError:g=>{y(!1),x(g)}};s&&(e!=null&&e.id)?(n.append("_method","PUT"),W.post(`/admin/products/${e.id}`,n,b)):W.post("/admin/products",n,b)},E=(r,n)=>{h(v=>({...v,[r]:n}))};return t.jsxs(he,{breadcrumbs:S,children:[t.jsx(ae,{title:s?"Edit Product":"Create Product"}),t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s?"Edit Product":"Create Product"}),t.jsx(N,{variant:"outline",asChild:!0,children:t.jsxs(U,{href:"/admin/products",children:[t.jsx(ge,{className:"mr-2 h-4 w-4"}),"Back to Products"]})})]}),t.jsx(fe,{}),t.jsx("form",{onSubmit:se,className:"space-y-8",children:t.jsxs(ce,{children:[t.jsx(le,{children:t.jsx(de,{children:"Product Details"})}),t.jsxs(ue,{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(C,{htmlFor:"name",children:"Name"}),t.jsx(k,{id:"name",value:m.name,onChange:r=>E("name",r.target.value),onBlur:z,placeholder:"Product Name"}),f.name&&t.jsx("p",{className:"text-destructive text-sm",children:f.name})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(C,{htmlFor:"slug",children:"Slug"}),t.jsx(k,{id:"slug",value:m.slug,onChange:r=>E("slug",r.target.value),placeholder:"product-slug"}),f.slug&&t.jsx("p",{className:"text-destructive text-sm",children:f.slug})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(C,{htmlFor:"price",children:"Price (IDR)"}),t.jsx(k,{id:"price",type:"number",value:m.price,onChange:r=>E("price",Number(r.target.value)),placeholder:"0",min:"0"}),f.price&&t.jsx("p",{className:"text-destructive text-sm",children:f.price})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(C,{htmlFor:"stock",children:"Stock"}),t.jsx(k,{id:"stock",type:"number",value:m.stock,onChange:r=>E("stock",Number(r.target.value)),placeholder:"0",min:"0"}),f.stock&&t.jsx("p",{className:"text-destructive text-sm",children:f.stock})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ee,{id:"is_active",checked:m.is_active,onCheckedChange:r=>E("is_active",r)}),t.jsx(C,{htmlFor:"is_active",children:"Active"}),f.is_active&&t.jsx("p",{className:"text-destructive text-sm",children:f.is_active})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(C,{htmlFor:"description",children:"Description"}),t.jsx(pe,{id:"description",value:m.description,onChange:r=>E("description",r.target.value),rows:5,placeholder:"Product description..."}),f.description&&t.jsx("p",{className:"text-destructive text-sm",children:f.description})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(C,{children:"Product Images"}),t.jsxs(N,{type:"button",variant:"outline",size:"sm",onClick:()=>{var r;return(r=document.getElementById("images"))==null?void 0:r.click()},children:[t.jsx(Se,{className:"mr-2 h-4 w-4"}),"Add Images"]}),t.jsx(k,{id:"images",type:"file",multiple:!0,className:"hidden",accept:"image/*",onChange:P})]}),f.new_images&&t.jsx("p",{className:"text-destructive text-sm",children:f.new_images}),t.jsx("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:c.map((r,n)=>t.jsxs("div",{className:`relative aspect-square overflow-hidden rounded-md border ${r.is_primary?"ring-primary ring-2":""}`,children:[t.jsx("img",{src:r.url,alt:`Preview ${n+1}`,className:"h-full w-full object-cover"}),t.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 transition-opacity hover:opacity-100",children:t.jsxs("div",{className:"absolute right-2 bottom-2 left-2 flex justify-between",children:[t.jsx(N,{type:"button",variant:r.is_primary?"default":"secondary",size:"sm",onClick:()=>R(n),disabled:r.is_primary,children:r.is_primary?"Primary":"Set Primary"}),t.jsx(N,{type:"button",variant:"destructive",size:"icon",onClick:()=>_(n),children:t.jsx(xe,{className:"h-4 w-4"})})]})})]},n))})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(C,{children:"Product Sizes"}),t.jsxs(N,{type:"button",variant:"outline",size:"sm",onClick:$,children:[t.jsx(ve,{className:"mr-2 h-4 w-4"}),"Add Size"]})]}),m.sizes.map((r,n)=>t.jsxs("div",{className:"grid grid-cols-12 items-center gap-4",children:[t.jsxs("div",{className:"col-span-5 space-y-2",children:[t.jsx(C,{htmlFor:`size-${n}`,children:"Size"}),t.jsx(k,{id:`size-${n}`,value:r.size,onChange:v=>A(n,"size",v.target.value),placeholder:"XL, L, M, S, etc."})]}),t.jsxs("div",{className:"col-span-5 space-y-2",children:[t.jsx(C,{htmlFor:`stock-${n}`,children:"Stock"}),t.jsx(k,{id:`stock-${n}`,type:"number",value:r.stock,onChange:v=>A(n,"stock",Number(v.target.value)),placeholder:"0",min:"0"})]}),t.jsx("div",{className:"col-span-2 pt-6",children:t.jsx(N,{type:"button",variant:"ghost",size:"icon",onClick:()=>te(n),disabled:m.sizes.length===1,children:t.jsx(ye,{className:"h-4 w-4"})})})]},n)),f.sizes&&t.jsx("p",{className:"text-destructive text-sm",children:f.sizes})]})]}),t.jsxs(me,{className:"flex justify-between",children:[t.jsx(N,{variant:"outline",type:"button",asChild:!0,children:t.jsx(U,{href:"/admin/products",children:"Cancel"})}),t.jsxs(N,{type:"submit",disabled:j,children:[t.jsx(be,{className:"mr-2 h-4 w-4"}),s?"Update Product":"Create Product"]})]})]})})]})]})}export{mt as default};
