import{r as l,j as e,L as K,S as U}from"./app-gVp8T97W.js";import{u as W,f as P,A as q,a as J,b as Q,c as X,d as Y,e as Z,g as ee,h as se,i as ae,j as te,k as ne,l as re}from"./alert-dialog-BLHL9vFc.js";import{B as j}from"./badge-ReQ3c7EH.js";import{I as le,B as i}from"./index-LawfOneF.js";import{C as o,a as u,b as f,e as N,c,d as ie}from"./card-M7fCHlBc.js";import{S as de,a as oe,b as ce,c as me,d as xe}from"./select-D8scCLju.js";import{S as ge}from"./separator-Cwt7ySMx.js";import{T as he,a as ue,b as v,c as pe,d as je,e as D}from"./table-BnA9lZZx.js";import{T as fe,a as Ne,b as m}from"./tabs-mRm9KW29.js";import{A as ve}from"./admin-layout-8SlhGllw.js";import{S as we}from"./search-D-qBty96.js";import{C as be}from"./chevron-left-AGn6Pgkr.js";import{C as Ce}from"./use-initials-D-ET1N7w.js";import{f as Se}from"./format-BlyJTOGp.js";import{A as w}from"./arrow-up-down-bZ5AbEef.js";import{E as F}from"./eye-Bizuqike.js";/* empty css            */import"./app-sidebar-header-CVHIOqUw.js";import"./app-logo-icon-C3zniST_.js";import"./breadcrumb-Cfb6gRVV.js";import"./Combination-CeemgJ7w.js";import"./index-e5tALGcz.js";import"./index-CAefynKf.js";import"./chevron-down-uaylTW6H.js";import"./chevron-up-CAESLesO.js";import"./package-BiWjSXjr.js";import"./pencil-6NnavDoC.js";const ye=[{title:"Dasbor",href:"/admin/dashboard"},{title:"Pesanan",href:"/admin/orders"}];function Ze({orders:M,statusCounts:r}){const[T,b]=l.useState(!1),[d,_]=l.useState(null),[A,R]=l.useState([]),[I,V]=l.useState([]),[L,z]=l.useState(!1),[p,B]=l.useState(""),[x,E]=l.useState("all");l.useEffect(()=>{const s=()=>{z(window.innerWidth<768)};return s(),window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[]);const C=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),S=s=>{const a=new Date(s);return Se(a,"dd MMM yyyy HH:mm")},y=s=>{switch(s){case"pending":return"default";case"processing":return"secondary";case"shipped":return"default";case"delivered":return"default";case"cancelled":return"destructive";default:return"secondary"}},H=s=>{var a,n;E(s),t&&t.getColumn("status")&&(s==="all"?(a=t.getColumn("status"))==null||a.setFilterValue(null):(n=t.getColumn("status"))==null||n.setFilterValue(s))},O=s=>{t.setPageSize(Number(s))},k=[{accessorKey:"order_number",header:({column:s})=>e.jsx("div",{className:"flex items-center",children:e.jsxs(i,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),className:"p-0 hover:bg-transparent",children:["No. Pesanan",e.jsx(w,{className:"ml-2 h-4 w-4"})]})}),cell:({row:s})=>e.jsx("span",{className:"font-medium",children:s.getValue("order_number")||`#${s.original.id}`}),enableColumnFilter:!0,filterFn:"includesString"},{accessorKey:"created_at",header:({column:s})=>e.jsx("div",{className:"flex items-center",children:e.jsxs(i,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),className:"p-0 hover:bg-transparent",children:["Tanggal",e.jsx(w,{className:"ml-2 h-4 w-4"})]})}),cell:({row:s})=>S(s.getValue("created_at")),sortingFn:(s,a,n)=>{const g=new Date(s.getValue(n)).getTime(),h=new Date(a.getValue(n)).getTime();return g<h?-1:g>h?1:0}},{accessorFn:s=>s.user?s.user.name:s.guest_name||"Guest",id:"customer",header:"Pelanggan",cell:({getValue:s})=>e.jsx("span",{children:s()}),enableColumnFilter:!0,filterFn:"includesString"},{accessorKey:"total_amount",header:({column:s})=>e.jsx("div",{className:"flex items-center",children:e.jsxs(i,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),className:"p-0 hover:bg-transparent",children:["Total",e.jsx(w,{className:"ml-2 h-4 w-4"})]})}),cell:({row:s})=>C(s.original.total_amount||s.original.total_price||0),sortingFn:(s,a,n)=>{const g=s.original.total_amount||s.original.total_price||0,h=a.original.total_amount||a.original.total_price||0;return g<h?-1:g>h?1:0}},{accessorKey:"status",header:"Status",cell:({row:s})=>{const a=s.getValue("status");return e.jsx(j,{variant:y(a),children:a.charAt(0).toUpperCase()+a.slice(1)})},enableColumnFilter:!0,filterFn:(s,a,n)=>!n||n==="all"?!0:s.getValue(a)===n},{accessorKey:"payment_status",header:"Pembayaran",cell:({row:s})=>{const a=s.getValue("payment_status");return e.jsx(j,{variant:a==="paid"?"default":"secondary",children:a.charAt(0).toUpperCase()+a.slice(1)})}},{id:"actions",header:"Aksi",cell:({row:s})=>{const a=s.original;return e.jsx(i,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx("a",{href:`/admin/orders/${a.id}`,children:e.jsx(F,{className:"h-4 w-4"})})})},enableSorting:!1}],t=W({data:M,columns:k,getCoreRowModel:re(),getPaginationRowModel:ne(),getFilteredRowModel:te(),onSortingChange:R,getSortedRowModel:ae(),onColumnFiltersChange:V,state:{sorting:A,columnFilters:I,pagination:{pageIndex:0,pageSize:10}},initialState:{pagination:{pageSize:10}},enableSorting:!0,enableFilters:!0});l.useEffect(()=>{if(!t)return;const s=setTimeout(()=>{var a,n;t.getColumn("order_number")&&((a=t.getColumn("order_number"))==null||a.setFilterValue(p)),t.getColumn("customer")&&((n=t.getColumn("customer"))==null||n.setFilterValue(p))},300);return()=>clearTimeout(s)},[p,t]),l.useEffect(()=>{var s;!t||!t.getColumn("status")||x&&x!=="all"&&((s=t.getColumn("status"))==null||s.setFilterValue(x))},[t,x]);const $=()=>{d&&U.delete(`/admin/orders/${d.id}`,{onSuccess:()=>{b(!1),_(null)}})},G=()=>t.getRowModel().rows.map(s=>{const a=s.original;return e.jsx(o,{className:"mb-4",children:e.jsxs(c,{className:"p-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium",children:a.order_number||`Order #${a.id}`}),e.jsx(j,{variant:y(a.status),className:"ml-2",children:a.status.charAt(0).toUpperCase()+a.status.slice(1)})]}),e.jsxs("div",{className:"my-2 grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Date"}),e.jsx("p",{className:"font-medium",children:S(a.created_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Customer"}),e.jsx("p",{className:"font-medium",children:a.user?a.user.name:a.guest_name||"Guest"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Amount"}),e.jsx("p",{className:"font-medium",children:C(a.total_amount||a.total_price||0)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Payment"}),e.jsx(j,{variant:a.payment_status==="paid"?"default":"secondary",children:a.payment_status.charAt(0).toUpperCase()+a.payment_status.slice(1)})]})]}),e.jsx("div",{className:"mt-4 flex justify-end space-x-2",children:e.jsx(i,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx("a",{href:`/admin/orders/${a.id}`,children:e.jsx(F,{className:"h-4 w-4"})})})})]})},a.id)});return e.jsxs(ve,{breadcrumbs:ye,children:[e.jsx(K,{title:"Manajemen Pesanan"}),e.jsxs("div",{className:"space-y-6 p-3 sm:p-6",children:[e.jsx("div",{className:"flex flex-col justify-between gap-4 sm:flex-row sm:items-center",children:e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Manajemen Pesanan"})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(o,{children:[e.jsxs(u,{className:"pb-2",children:[e.jsx(f,{children:"Semua Pesanan"}),e.jsx(N,{children:"Ringkasan pesanan"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.all}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Total pesanan dalam sistem"})]})]}),e.jsxs(o,{children:[e.jsxs(u,{className:"pb-2",children:[e.jsx(f,{children:"Menunggu"}),e.jsx(N,{children:"Pesanan yang perlu diproses"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.pending}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Menunggu untuk diproses"})]})]}),e.jsxs(o,{children:[e.jsxs(u,{className:"pb-2",children:[e.jsx(f,{children:"Diproses"}),e.jsx(N,{children:"Pesanan dalam proses"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.processing}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Sedang ditangani"})]})]}),e.jsxs(o,{children:[e.jsxs(u,{className:"pb-2",children:[e.jsx(f,{children:"Dikirim"}),e.jsx(N,{children:"Pesanan terkirim"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.shipped+r.delivered}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Pesanan dikirim atau diterima"})]})]})]}),e.jsx(ge,{}),e.jsxs(o,{children:[e.jsx(u,{className:"px-4 py-4 sm:px-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:e.jsxs("div",{className:"relative w-full sm:max-w-xs",children:[e.jsx(we,{className:"text-muted-foreground absolute top-2.5 left-2.5 h-4 w-4"}),e.jsx(le,{type:"search",name:"search",placeholder:"Cari pesanan...",value:p,onChange:s=>B(s.target.value),className:"w-full pl-8"})]})}),e.jsx(fe,{value:x,onValueChange:H,children:e.jsxs(Ne,{className:"grid w-full auto-cols-max grid-flow-col overflow-x-auto sm:flex sm:w-auto",children:[e.jsxs(m,{className:"min-w-[100px] text-center",value:"all",children:["Semua (",r.all,")"]}),e.jsxs(m,{className:"min-w-[100px] text-center",value:"pending",children:["Menunggu (",r.pending,")"]}),e.jsxs(m,{className:"min-w-[100px] text-center",value:"processing",children:["Diproses (",r.processing,")"]}),e.jsxs(m,{className:"min-w-[100px] text-center",value:"shipped",children:["Dikirim (",r.shipped,")"]}),e.jsxs(m,{className:"min-w-[100px] text-center",value:"delivered",children:["Diterima (",r.delivered,")"]}),e.jsxs(m,{className:"min-w-[100px] text-center",value:"cancelled",children:["Dibatalkan (",r.cancelled,")"]})]})})]})}),e.jsx(c,{className:"px-4 sm:px-6",children:L?e.jsx("div",{className:"py-2",children:t.getRowModel().rows.length?G():e.jsx("div",{className:"text-muted-foreground py-10 text-center",children:"Tidak ada pesanan ditemukan"})}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(he,{children:[e.jsx(ue,{children:t.getHeaderGroups().map(s=>e.jsx(v,{children:s.headers.map(a=>e.jsx(pe,{children:a.isPlaceholder?null:P(a.column.columnDef.header,a.getContext())},a.id))},s.id))}),e.jsx(je,{children:t.getRowModel().rows.length?t.getRowModel().rows.map(s=>e.jsx(v,{"data-state":s.original.status==="cancelled"?"destructive":void 0,children:s.getVisibleCells().map(a=>e.jsx(D,{children:P(a.column.columnDef.cell,a.getContext())},a.id))},s.id)):e.jsx(v,{children:e.jsx(D,{colSpan:k.length,className:"h-24 text-center",children:"Tidak ada pesanan ditemukan"})})})]})})}),e.jsx(ie,{className:"border-t px-4 py-4 sm:px-6",children:e.jsxs("div",{className:"flex w-full flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"text-muted-foreground text-center text-sm sm:text-left",children:["Menampilkan"," ",t.getFilteredRowModel().rows.length>0?t.getState().pagination.pageIndex*t.getState().pagination.pageSize+1:0," ","sampai"," ",Math.min((t.getState().pagination.pageIndex+1)*t.getState().pagination.pageSize,t.getFilteredRowModel().rows.length)," ","dari ",t.getFilteredRowModel().rows.length," pesanan"]}),e.jsxs("div",{className:"flex flex-col items-center gap-4 sm:flex-row sm:gap-6 lg:gap-8",children:[e.jsxs("div",{className:"flex w-full items-center gap-2 sm:w-auto",children:[e.jsx("p",{className:"text-sm font-medium whitespace-nowrap",children:"Rows per page"}),e.jsxs(de,{value:String(t.getState().pagination.pageSize),onValueChange:O,children:[e.jsx(oe,{className:"h-8 w-[80px]",children:e.jsx(ce,{placeholder:t.getState().pagination.pageSize})}),e.jsx(me,{side:"top",children:[5,10,20,30,50,100].map(s=>e.jsx(xe,{value:`${s}`,children:s},s))})]})]}),e.jsx("div",{className:"flex w-full items-center justify-center sm:w-auto",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(i,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>t.setPageIndex(0),disabled:!t.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-chevrons-left",children:[e.jsx("path",{d:"m11 17-5-5 5-5"}),e.jsx("path",{d:"m18 17-5-5 5-5"})]})]}),e.jsxs(i,{variant:"outline",className:"h-8 w-8 p-0 sm:h-9 sm:w-9",onClick:()=>t.previousPage(),disabled:!t.getCanPreviousPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(be,{className:"h-4 w-4"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-sm",children:"Page"}),e.jsxs("strong",{className:"text-sm font-medium",children:[t.getState().pagination.pageIndex+1," of ",t.getPageCount()]})]}),e.jsxs(i,{variant:"outline",className:"h-8 w-8 p-0 sm:h-9 sm:w-9",onClick:()=>t.nextPage(),disabled:!t.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(Ce,{className:"h-4 w-4"})]}),e.jsxs(i,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>t.setPageIndex(t.getPageCount()-1),disabled:!t.getCanNextPage(),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-chevrons-right",children:[e.jsx("path",{d:"m6 17 5-5-5-5"}),e.jsx("path",{d:"m13 17 5-5-5-5"})]})]})]})})]})]})})]})]}),e.jsx(q,{open:T,onOpenChange:b,children:e.jsxs(J,{children:[e.jsxs(Q,{children:[e.jsx(X,{children:"Apakah Anda yakin?"}),e.jsxs(Y,{children:["Tindakan ini akan menghapus pesanan"," ",e.jsx("span",{className:"font-semibold",children:(d==null?void 0:d.order_number)||`#${d==null?void 0:d.id}`})," secara permanen. Tindakan ini tidak dapat dibatalkan."]})]}),e.jsxs(Z,{children:[e.jsx(ee,{children:"Batal"}),e.jsx(se,{onClick:$,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Hapus"})]})]})})]})}export{Ze as default};
