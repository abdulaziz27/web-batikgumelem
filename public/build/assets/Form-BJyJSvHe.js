import{r as o,j as t,t as re,m as ie,L as ne,$ as O}from"./app-CYDLR7DQ.js";import{c as ae,a as U,B as C,I as N}from"./index-C6SDhB8v.js";import{C as oe,a as ce,b as le,c as de,d as ue}from"./card-NVK-lCst.js";import{L as S}from"./label-Br-Y0vsU.js";import{S as me}from"./separator-BoPlGso7.js";import{T as fe}from"./textarea-BjZmX0iY.js";import{A as he}from"./admin-layout-CnvSajRV.js";import{A as pe}from"./arrow-left-BXkajAj7.js";import{X as xe}from"./use-initials-BU6pEj1R.js";import{P as ge}from"./plus-CB7P8F6Q.js";import{M as ve}from"./minus-DN0qFGvg.js";import{S as ye}from"./save-Ba8F-tT5.js";/* empty css            */import"./app-sidebar-header-rASVoSnQ.js";import"./app-logo-icon-BGK4uD7Q.js";import"./breadcrumb-CcI3hiRC.js";import"./Combination-Dbugd-ik.js";import"./index-B2zMfxgR.js";import"./package-C1XeRBSI.js";import"./pencil-4ow-Rv7N.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],je=ae("Upload",be);function Se(e,s,{checkForDefaultPrevented:i=!0}={}){return function(r){if(e==null||e(r),i===!1||!r.defaultPrevented)return s==null?void 0:s(r)}}function W(e,s){if(typeof e=="function")return e(s);e!=null&&(e.current=s)}function we(...e){return s=>{let i=!1;const a=e.map(r=>{const c=W(r,s);return!i&&typeof c=="function"&&(i=!0),c});if(i)return()=>{for(let r=0;r<a.length;r++){const c=a[r];typeof c=="function"?c():W(e[r],null)}}}}function R(...e){return o.useCallback(we(...e),e)}function Ce(e,s=[]){let i=[];function a(c,d){const l=o.createContext(d),u=i.length;i=[...i,d];const g=m=>{var w;const{scope:f,children:p,...b}=m,j=((w=f==null?void 0:f[e])==null?void 0:w[u])||l,k=o.useMemo(()=>b,Object.values(b));return t.jsx(j.Provider,{value:k,children:p})};g.displayName=c+"Provider";function x(m,f){var j;const p=((j=f==null?void 0:f[e])==null?void 0:j[u])||l,b=o.useContext(p);if(b)return b;if(d!==void 0)return d;throw new Error(`\`${m}\` must be used within \`${c}\``)}return[g,x]}const r=()=>{const c=i.map(d=>o.createContext(d));return function(l){const u=(l==null?void 0:l[e])||c;return o.useMemo(()=>({[`__scope${e}`]:{...l,[e]:u}}),[l,u])}};return r.scopeName=e,[a,Ne(r,...s)]}function Ne(...e){const s=e[0];if(e.length===1)return s;const i=()=>{const a=e.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(c){const d=a.reduce((l,{useScope:u,scopeName:g})=>{const m=u(c)[`__scope${g}`];return{...l,...m}},{});return o.useMemo(()=>({[`__scope${s.scopeName}`]:d}),[d])}};return i.scopeName=s.scopeName,i}var V=globalThis!=null&&globalThis.document?o.useLayoutEffect:()=>{},ke=re[" useInsertionEffect ".trim().toString()]||V;function _e({prop:e,defaultProp:s,onChange:i=()=>{},caller:a}){const[r,c,d]=Pe({defaultProp:s,onChange:i}),l=e!==void 0,u=l?e:r;{const x=o.useRef(e!==void 0);o.useEffect(()=>{const m=x.current;m!==l&&console.warn(`${a} is changing from ${m?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),x.current=l},[l,a])}const g=o.useCallback(x=>{var m;if(l){const f=ze(x)?x(e):x;f!==e&&((m=d.current)==null||m.call(d,f))}else c(x)},[l,e,c,d]);return[u,g]}function Pe({defaultProp:e,onChange:s}){const[i,a]=o.useState(e),r=o.useRef(i),c=o.useRef(s);return ke(()=>{c.current=s},[s]),o.useEffect(()=>{var d;r.current!==i&&((d=c.current)==null||d.call(c,i),r.current=i)},[i,r]),[i,a,c]}function ze(e){return typeof e=="function"}function Ie(e){const s=o.useRef({value:e,previous:e});return o.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}function Re(e){const[s,i]=o.useState(void 0);return V(()=>{if(e){i({width:e.offsetWidth,height:e.offsetHeight});const a=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const c=r[0];let d,l;if("borderBoxSize"in c){const u=c.borderBoxSize,g=Array.isArray(u)?u[0]:u;d=g.inlineSize,l=g.blockSize}else d=e.offsetWidth,l=e.offsetHeight;i({width:d,height:l})});return a.observe(e,{box:"border-box"}),()=>a.unobserve(e)}else i(void 0)},[e]),s}function Ee(e){const s=$e(e),i=o.forwardRef((a,r)=>{const{children:c,...d}=a,l=o.Children.toArray(c),u=l.find(Fe);if(u){const g=u.props.children,x=l.map(m=>m===u?o.Children.count(g)>1?o.Children.only(null):o.isValidElement(g)?g.props.children:null:m);return t.jsx(s,{...d,ref:r,children:o.isValidElement(g)?o.cloneElement(g,void 0,x):null})}return t.jsx(s,{...d,ref:r,children:c})});return i.displayName=`${e}.Slot`,i}function $e(e){const s=o.forwardRef((i,a)=>{const{children:r,...c}=i,d=o.isValidElement(r)?Le(r):void 0,l=R(d,a);if(o.isValidElement(r)){const u=Be(c,r.props);return r.type!==o.Fragment&&(u.ref=l),o.cloneElement(r,u)}return o.Children.count(r)>1?o.Children.only(null):null});return s.displayName=`${e}.SlotClone`,s}var Ae=Symbol("radix.slottable");function Fe(e){return o.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Ae}function Be(e,s){const i={...s};for(const a in s){const r=e[a],c=s[a];/^on[A-Z]/.test(a)?r&&c?i[a]=(...l)=>{const u=c(...l);return r(...l),u}:r&&(i[a]=r):a==="style"?i[a]={...r,...c}:a==="className"&&(i[a]=[r,c].filter(Boolean).join(" "))}return{...e,...i}}function Le(e){var a,r;let s=(a=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:a.get,i=s&&"isReactWarning"in s&&s.isReactWarning;return i?e.ref:(s=(r=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:r.get,i=s&&"isReactWarning"in s&&s.isReactWarning,i?e.props.ref:e.props.ref||e.ref)}var De=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],q=De.reduce((e,s)=>{const i=Ee(`Primitive.${s}`),a=o.forwardRef((r,c)=>{const{asChild:d,...l}=r,u=d?i:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),t.jsx(u,{...l,ref:c})});return a.displayName=`Primitive.${s}`,{...e,[s]:a}},{}),P="Switch",[Te,dt]=Ce(P),[Me,Oe]=Te(P),H=o.forwardRef((e,s)=>{const{__scopeSwitch:i,name:a,checked:r,defaultChecked:c,required:d,disabled:l,value:u="on",onCheckedChange:g,form:x,...m}=e,[f,p]=o.useState(null),b=R(s,_=>p(_)),j=o.useRef(!1),k=f?x||!!f.closest("form"):!0,[w,z]=_e({prop:r,defaultProp:c??!1,onChange:g,caller:P});return t.jsxs(Me,{scope:i,checked:w,disabled:l,children:[t.jsx(q.button,{type:"button",role:"switch","aria-checked":w,"aria-required":d,"data-state":J(w),"data-disabled":l?"":void 0,disabled:l,value:u,...m,ref:b,onClick:Se(e.onClick,_=>{z(I=>!I),k&&(j.current=_.isPropagationStopped(),j.current||_.stopPropagation())})}),k&&t.jsx(Z,{control:f,bubbles:!j.current,name:a,value:u,checked:w,required:d,disabled:l,form:x,style:{transform:"translateX(-100%)"}})]})});H.displayName=P;var X="SwitchThumb",G=o.forwardRef((e,s)=>{const{__scopeSwitch:i,...a}=e,r=Oe(X,i);return t.jsx(q.span,{"data-state":J(r.checked),"data-disabled":r.disabled?"":void 0,...a,ref:s})});G.displayName=X;var Ue="SwitchBubbleInput",Z=o.forwardRef(({__scopeSwitch:e,control:s,checked:i,bubbles:a=!0,...r},c)=>{const d=o.useRef(null),l=R(d,c),u=Ie(i),g=Re(s);return o.useEffect(()=>{const x=d.current;if(!x)return;const m=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(m,"checked").set;if(u!==i&&p){const b=new Event("click",{bubbles:a});p.call(x,i),x.dispatchEvent(b)}},[u,i,a]),t.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i,...r,tabIndex:-1,ref:l,style:{...r.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Z.displayName=Ue;function J(e){return e?"checked":"unchecked"}var K=H,We=G;const Q=o.forwardRef(({className:e,...s},i)=>t.jsx(K,{className:U("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...s,ref:i,children:t.jsx(We,{className:U("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Q.displayName=K.displayName;function ut({product:e,isEdit:s=!1}){var $,A,F,B;const i=(($=e==null?void 0:e.images)==null?void 0:$.map(n=>({id:n.id,url:`/storage/${n.image}`,is_primary:n.is_primary})))||[],[a,r]=o.useState(i),[c,d]=o.useState([]),[l,u]=o.useState([]),[g,x]=o.useState(((F=(A=e==null?void 0:e.images)==null?void 0:A.find(n=>n.is_primary))==null?void 0:F.id)||null),{data:m,setData:f,errors:p,processing:b,post:j,put:k}=ie({name:(e==null?void 0:e.name)||"",slug:(e==null?void 0:e.slug)||"",description:(e==null?void 0:e.description)||"",price:(e==null?void 0:e.price)||0,stock:(e==null?void 0:e.stock)||0,is_active:(e==null?void 0:e.is_active)??!0,sizes:((B=e==null?void 0:e.sizes)==null?void 0:B.map(n=>({id:n.id,size:n.size,stock:n.stock})))||[{size:"",stock:0}],deleted_image_ids:[],primary_image_id:g,new_images:[]}),w=[{title:"Dashboard",href:"/admin/dashboard"},{title:"Products",href:"/admin/products"},{title:s?"Edit Product":"Create Product",href:s?`/admin/products/${e==null?void 0:e.id}/edit`:"/admin/products/create"}],z=n=>{const h=n.target.files;if(!h||h.length===0)return;const v=Array.from(h);d([...c,...v]),v.forEach(y=>{const L=new FileReader;L.onload=D=>{var T;(T=D.target)!=null&&T.result&&r(M=>[...M,{url:D.target.result,is_primary:a.length===0&&M.length===0}])},L.readAsDataURL(y)}),f("new_images",[...c,...v])},_=(n,h)=>{if(h&&(u([...l,h]),f("deleted_image_ids",[...l,h]),g===h&&(x(null),f("primary_image_id",null))),r(a.filter((v,y)=>y!==n)),!h&&n>=(i.length||0)){const v=n-(i.length||0),y=[...c];y.splice(v,1),d(y),f("new_images",y)}},I=(n,h)=>{r(a.map((v,y)=>({...v,is_primary:y===n}))),h?(x(h),f("primary_image_id",h)):x(null)},Y=()=>{if(typeof m.name=="string"){const n=m.name.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-");f("slug",n)}},ee=()=>{f("sizes",[...m.sizes,{size:"",stock:0}])},te=n=>{f("sizes",m.sizes.filter((h,v)=>v!==n))},E=(n,h,v)=>{const y=[...m.sizes];y[n]={...y[n],[h]:v},f("sizes",y)},se=n=>{n.preventDefault(),s&&(e!=null&&e.id)?k(`/admin/products/${e.id}`):j("/admin/products")};return t.jsxs(he,{breadcrumbs:w,children:[t.jsx(ne,{title:s?"Edit Product":"Create Product"}),t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s?"Edit Product":"Create Product"}),t.jsx(C,{variant:"outline",asChild:!0,children:t.jsxs(O,{href:"/admin/products",children:[t.jsx(pe,{className:"mr-2 h-4 w-4"}),"Back to Products"]})})]}),t.jsx(me,{}),t.jsx("form",{onSubmit:se,className:"space-y-8",children:t.jsxs(oe,{children:[t.jsx(ce,{children:t.jsx(le,{children:"Product Details"})}),t.jsxs(de,{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(S,{htmlFor:"name",children:"Name"}),t.jsx(N,{id:"name",value:m.name,onChange:n=>f("name",n.target.value),onBlur:Y,placeholder:"Product Name"}),p.name&&t.jsx("p",{className:"text-destructive text-sm",children:p.name})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(S,{htmlFor:"slug",children:"Slug"}),t.jsx(N,{id:"slug",value:m.slug,onChange:n=>f("slug",n.target.value),placeholder:"product-slug"}),p.slug&&t.jsx("p",{className:"text-destructive text-sm",children:p.slug})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(S,{htmlFor:"price",children:"Price (IDR)"}),t.jsx(N,{id:"price",type:"number",value:m.price,onChange:n=>f("price",Number(n.target.value)),placeholder:"0",min:"0"}),p.price&&t.jsx("p",{className:"text-destructive text-sm",children:p.price})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(S,{htmlFor:"stock",children:"Stock"}),t.jsx(N,{id:"stock",type:"number",value:m.stock,onChange:n=>f("stock",Number(n.target.value)),placeholder:"0",min:"0"}),p.stock&&t.jsx("p",{className:"text-destructive text-sm",children:p.stock})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Q,{id:"is_active",checked:m.is_active,onCheckedChange:n=>f("is_active",n)}),t.jsx(S,{htmlFor:"is_active",children:"Active"}),p.is_active&&t.jsx("p",{className:"text-destructive text-sm",children:p.is_active})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(S,{htmlFor:"description",children:"Description"}),t.jsx(fe,{id:"description",value:m.description,onChange:n=>f("description",n.target.value),rows:5,placeholder:"Product description..."}),p.description&&t.jsx("p",{className:"text-destructive text-sm",children:p.description})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(S,{children:"Product Images"}),t.jsxs(C,{type:"button",variant:"outline",size:"sm",onClick:()=>{var n;return(n=document.getElementById("images"))==null?void 0:n.click()},children:[t.jsx(je,{className:"mr-2 h-4 w-4"}),"Add Images"]}),t.jsx(N,{id:"images",type:"file",multiple:!0,className:"hidden",accept:"image/*",onChange:z})]}),p.new_images&&t.jsx("p",{className:"text-destructive text-sm",children:p.new_images}),t.jsx("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:a.map((n,h)=>t.jsxs("div",{className:`relative aspect-square overflow-hidden rounded-md border ${n.is_primary?"ring-primary ring-2":""}`,children:[t.jsx("img",{src:n.url,alt:`Preview ${h+1}`,className:"h-full w-full object-cover"}),t.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 transition-opacity hover:opacity-100",children:t.jsxs("div",{className:"absolute right-2 bottom-2 left-2 flex justify-between",children:[t.jsx(C,{type:"button",variant:n.is_primary?"default":"secondary",size:"sm",onClick:()=>I(h,n.id),disabled:n.is_primary,children:n.is_primary?"Primary":"Set Primary"}),t.jsx(C,{type:"button",variant:"destructive",size:"icon",onClick:()=>_(h,n.id),children:t.jsx(xe,{className:"h-4 w-4"})})]})})]},h))})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(S,{children:"Product Sizes"}),t.jsxs(C,{type:"button",variant:"outline",size:"sm",onClick:ee,children:[t.jsx(ge,{className:"mr-2 h-4 w-4"}),"Add Size"]})]}),m.sizes.map((n,h)=>t.jsxs("div",{className:"grid grid-cols-12 items-center gap-4",children:[t.jsxs("div",{className:"col-span-5 space-y-2",children:[t.jsx(S,{htmlFor:`size-${h}`,children:"Size"}),t.jsx(N,{id:`size-${h}`,value:n.size,onChange:v=>E(h,"size",v.target.value),placeholder:"XL, L, M, S, etc."})]}),t.jsxs("div",{className:"col-span-5 space-y-2",children:[t.jsx(S,{htmlFor:`stock-${h}`,children:"Stock"}),t.jsx(N,{id:`stock-${h}`,type:"number",value:n.stock,onChange:v=>E(h,"stock",Number(v.target.value)),placeholder:"0",min:"0"})]}),t.jsx("div",{className:"col-span-2 pt-6",children:t.jsx(C,{type:"button",variant:"ghost",size:"icon",onClick:()=>te(h),disabled:m.sizes.length===1,children:t.jsx(ve,{className:"h-4 w-4"})})})]},h)),p.sizes&&t.jsx("p",{className:"text-destructive text-sm",children:p.sizes})]})]}),t.jsxs(ue,{className:"flex justify-between",children:[t.jsx(C,{variant:"outline",type:"button",asChild:!0,children:t.jsx(O,{href:"/admin/products",children:"Cancel"})}),t.jsxs(C,{type:"submit",disabled:b,children:[t.jsx(ye,{className:"mr-2 h-4 w-4"}),s?"Update Product":"Create Product"]})]})]})})]})]})}export{ut as default};
