import{r as t,u as w,j as e,L as C,S as c}from"./app-DfJ_0T5P.js";import{L as P}from"./Layout-t_Tq0bCz.js";import{c as g,B as p}from"./index-DEqMiAcq.js";import{C as S,a as _,b as E,e as L,c as M,d as A}from"./card-rQGJHwBd.js";import{a as F}from"./formatters-NwLEpD3y.js";import{C as I}from"./clock-D8LR8TGp.js";import{L as k}from"./loader-circle-B_7hx86z.js";import{C as T}from"./credit-card-D2ukIO6S.js";/* empty css            */import"./use-initials-CmAI_RPG.js";import"./Combination-NavuyeJM.js";import"./map-pin-Cz7Nvj68.js";import"./badge-BAmadApz.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],B=g("CircleAlert",$);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],D=g("RefreshCw",R),Z=({order:s,midtrans_client_key:o="",is_production:h=!1})=>{const[x,u]=t.useState(!1),[y,r]=t.useState(!1),[n,N]=t.useState(""),[m,d]=t.useState(null);let f=()=>{};try{f=w().clearCart}catch{console.warn("Cart provider not available, using fallback")}t.useEffect(()=>{try{f()}catch(a){console.warn("Error clearing cart:",a)}},[]),t.useEffect(()=>{let a="";if(s!=null&&s.payment_token)a=s.payment_token;else if(s!=null&&s.payment_url){const l=s.payment_url.match(/([^\/]+)$/);l&&l[1]&&(a=l[1])}N(a)},[s]),t.useEffect(()=>{if(!n||!o)return;const a=document.getElementById("midtrans-script");a&&document.body.removeChild(a);const l=h?"https://app.midtrans.com/snap/snap.js":"https://app.sandbox.midtrans.com/snap/snap.js",i=document.createElement("script");return i.id="midtrans-script",i.src=l,i.setAttribute("data-client-key",o),i.onload=()=>console.log("Snap.js loaded successfully"),i.onerror=()=>d("Gagal memuat payment processor"),document.body.appendChild(i),()=>{const b=document.getElementById("midtrans-script");b&&document.body.removeChild(b)}},[n,o,h]);const v=()=>{if(!n){d("Token pembayaran tidak valid");return}r(!0),window.snap?window.snap.pay(n,{onSuccess:function(a){console.log("Payment success:",a),r(!1),c.visit(`/checkout/success?order_id=${a.order_id}`)},onPending:function(a){console.log("Payment pending:",a),r(!1),j()},onError:function(a){console.error("Payment error:",a),r(!1),c.visit(`/checkout/failed?order_id=${a.order_id}`)},onClose:function(){console.log("Payment widget closed without completion"),r(!1)}}):(d("Payment gateway not initialized"),r(!1))},j=()=>{u(!0),c.visit(`/checkout/check-payment/${s.order_number}`,{preserveState:!0,onFinish:()=>u(!1),onError:a=>{console.error("Error checking payment status:",a)}})};return e.jsxs(P,{children:[e.jsx(C,{title:"Pembayaran Pesanan"}),e.jsx("div",{className:"container mx-auto px-4 py-12 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"mx-auto max-w-3xl",children:[e.jsx("div",{className:"mb-8",children:e.jsx("h1",{className:"text-batik-brown text-2xl font-bold tracking-tight",children:"Pembayaran Pesanan"})}),e.jsxs(S,{children:[e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"h-5 w-5 text-yellow-500"}),e.jsx(E,{children:"Pembayaran Dalam Proses"})]}),e.jsx(L,{children:"Silakan selesaikan pembayaran Anda sesuai instruksi"})]}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg bg-gray-50 p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Nomor Pesanan"}),e.jsx("span",{className:"font-mono",children:s.order_number})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total Pembayaran"}),e.jsx("span",{className:"font-semibold",children:F(s.total_amount)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Metode Pembayaran"}),e.jsx("span",{className:"capitalize",children:s.payment_method.replace("_"," ")})]})]})}),e.jsxs("div",{className:"rounded-lg border border-yellow-200 bg-yellow-50 p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{className:"h-5 w-5 text-yellow-500"}),e.jsx("span",{className:"font-medium text-yellow-800",children:"Menunggu Pembayaran"})]}),e.jsx("p",{className:"mt-2 text-sm text-yellow-700",children:"Mohon selesaikan pembayaran Anda dalam waktu 24 jam untuk menghindari pembatalan otomatis"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Instruksi Pembayaran:"}),e.jsx("div",{className:"rounded-lg border p-4",children:e.jsxs("ol",{className:"list-decimal space-y-2 pl-4",children:[e.jsxs("li",{children:["Catat nomor pesanan Anda: ",e.jsx("span",{className:"font-mono font-medium",children:s.order_number})]}),e.jsx("li",{children:"Lakukan pembayaran sesuai total yang tertera"}),e.jsx("li",{children:"Pembayaran akan diverifikasi secara otomatis oleh sistem"}),e.jsx("li",{children:"Status pesanan Anda akan diperbarui setelah pembayaran terverifikasi"})]})})]})]})}),e.jsxs(A,{className:"flex flex-col space-y-4",children:[n&&e.jsx(p,{onClick:v,disabled:y||!!m,className:"bg-batik-brown hover:bg-batik-brown/90 w-full",children:y?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"mr-2 h-4 w-4 animate-spin"}),"Memproses Pembayaran..."]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"Bayar Sekarang"]})}),e.jsx(p,{onClick:j,disabled:x,variant:n?"outline":"default",className:n?"w-full":"bg-batik-indigo hover:bg-batik-indigo/90 w-full",children:x?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"mr-2 h-4 w-4 animate-spin"}),"Memeriksa Status..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),"Cek Status Pembayaran"]})}),e.jsx(p,{variant:"outline",onClick:()=>c.visit(`/orders/detail/${s.order_number}`),className:"w-full",children:"Lihat Detail Pesanan"}),m&&e.jsx("div",{className:"rounded-md bg-red-50 p-3 w-full",children:e.jsx("div",{className:"text-sm text-red-700",children:m})})]})]})]})})]})};export{Z as default};
