import{r as c,j as s,t as le,L as de,$ as ue,S as H}from"./app-rImy3gZT.js";import{c as K,a as q,B as _,I as N}from"./index-Bdlz4M_o.js";import{C as F,a as T,b as A,c as D}from"./card-Cuy3nzY6.js";import{L as C}from"./label-C9G3gqy2.js";import{S as me}from"./separator-GMhAo5go.js";import{T as fe}from"./textarea-B6mUzlv_.js";import{A as pe}from"./admin-layout-DU3y_xgX.js";import{A as he}from"./arrow-left-DlU4Mn00.js";import{S as ge}from"./save-BaclSbR5.js";import{X as xe}from"./use-initials-BbuuFBUP.js";import{P as ve}from"./plus-C7os38EX.js";import{M as ye}from"./minus-BC8G_9Oe.js";/* empty css            */import"./app-sidebar-header-BcWl8kWB.js";import"./app-logo-icon-BTEMKZVK.js";import"./breadcrumb-8_6pmLZ2.js";import"./Combination-Ch-U0Asv.js";import"./index-DaXdPf2M.js";import"./package-HzhcpqVq.js";import"./pencil-c70Ezx40.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],je=K("Star",be);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],we=K("Upload",Se);function ke(e,t,{checkForDefaultPrevented:i=!0}={}){return function(r){if(e==null||e(r),i===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}function J(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Ce(...e){return t=>{let i=!1;const o=e.map(r=>{const d=J(r,t);return!i&&typeof d=="function"&&(i=!0),d});if(i)return()=>{for(let r=0;r<o.length;r++){const d=o[r];typeof d=="function"?d():J(e[r],null)}}}}function L(...e){return c.useCallback(Ce(...e),e)}function _e(e,t=[]){let i=[];function o(d,u){const l=c.createContext(u),f=i.length;i=[...i,u];const m=g=>{var k;const{scope:x,children:j,...y}=g,S=((k=x==null?void 0:x[e])==null?void 0:k[f])||l,P=c.useMemo(()=>y,Object.values(y));return s.jsx(S.Provider,{value:P,children:j})};m.displayName=d+"Provider";function p(g,x){var S;const j=((S=x==null?void 0:x[e])==null?void 0:S[f])||l,y=c.useContext(j);if(y)return y;if(u!==void 0)return u;throw new Error(`\`${g}\` must be used within \`${d}\``)}return[m,p]}const r=()=>{const d=i.map(u=>c.createContext(u));return function(l){const f=(l==null?void 0:l[e])||d;return c.useMemo(()=>({[`__scope${e}`]:{...l,[e]:f}}),[l,f])}};return r.scopeName=e,[o,Ne(r,...t)]}function Ne(...e){const t=e[0];if(e.length===1)return t;const i=()=>{const o=e.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(d){const u=o.reduce((l,{useScope:f,scopeName:m})=>{const g=f(d)[`__scope${m}`];return{...l,...g}},{});return c.useMemo(()=>({[`__scope${t.scopeName}`]:u}),[u])}};return i.scopeName=t.scopeName,i}var X=globalThis!=null&&globalThis.document?c.useLayoutEffect:()=>{},Pe=le[" useInsertionEffect ".trim().toString()]||X;function ze({prop:e,defaultProp:t,onChange:i=()=>{},caller:o}){const[r,d,u]=Ee({defaultProp:t,onChange:i}),l=e!==void 0,f=l?e:r;{const p=c.useRef(e!==void 0);c.useEffect(()=>{const g=p.current;g!==l&&console.warn(`${o} is changing from ${g?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),p.current=l},[l,o])}const m=c.useCallback(p=>{var g;if(l){const x=Ie(p)?p(e):p;x!==e&&((g=u.current)==null||g.call(u,x))}else d(p)},[l,e,d,u]);return[f,m]}function Ee({defaultProp:e,onChange:t}){const[i,o]=c.useState(e),r=c.useRef(i),d=c.useRef(t);return Pe(()=>{d.current=t},[t]),c.useEffect(()=>{var u;r.current!==i&&((u=d.current)==null||u.call(d,i),r.current=i)},[i,r]),[i,o,d]}function Ie(e){return typeof e=="function"}function Re(e){const t=c.useRef({value:e,previous:e});return c.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}function $e(e){const[t,i]=c.useState(void 0);return X(()=>{if(e){i({width:e.offsetWidth,height:e.offsetHeight});const o=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const d=r[0];let u,l;if("borderBoxSize"in d){const f=d.borderBoxSize,m=Array.isArray(f)?f[0]:f;u=m.inlineSize,l=m.blockSize}else u=e.offsetWidth,l=e.offsetHeight;i({width:u,height:l})});return o.observe(e,{box:"border-box"}),()=>o.unobserve(e)}else i(void 0)},[e]),t}function Fe(e){const t=Te(e),i=c.forwardRef((o,r)=>{const{children:d,...u}=o,l=c.Children.toArray(d),f=l.find(De);if(f){const m=f.props.children,p=l.map(g=>g===f?c.Children.count(m)>1?c.Children.only(null):c.isValidElement(m)?m.props.children:null:g);return s.jsx(t,{...u,ref:r,children:c.isValidElement(m)?c.cloneElement(m,void 0,p):null})}return s.jsx(t,{...u,ref:r,children:d})});return i.displayName=`${e}.Slot`,i}function Te(e){const t=c.forwardRef((i,o)=>{const{children:r,...d}=i,u=c.isValidElement(r)?Be(r):void 0,l=L(u,o);if(c.isValidElement(r)){const f=Le(d,r.props);return r.type!==c.Fragment&&(f.ref=l),c.cloneElement(r,f)}return c.Children.count(r)>1?c.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Ae=Symbol("radix.slottable");function De(e){return c.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Ae}function Le(e,t){const i={...t};for(const o in t){const r=e[o],d=t[o];/^on[A-Z]/.test(o)?r&&d?i[o]=(...l)=>{const f=d(...l);return r(...l),f}:r&&(i[o]=r):o==="style"?i[o]={...r,...d}:o==="className"&&(i[o]=[r,d].filter(Boolean).join(" "))}return{...e,...i}}function Be(e){var o,r;let t=(o=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:o.get,i=t&&"isReactWarning"in t&&t.isReactWarning;return i?e.ref:(t=(r=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:r.get,i=t&&"isReactWarning"in t&&t.isReactWarning,i?e.props.ref:e.props.ref||e.ref)}var Me=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Z=Me.reduce((e,t)=>{const i=Fe(`Primitive.${t}`),o=c.forwardRef((r,d)=>{const{asChild:u,...l}=r,f=u?i:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(f,{...l,ref:d})});return o.displayName=`Primitive.${t}`,{...e,[t]:o}},{}),I="Switch",[Ue,ms]=_e(I),[Oe,We]=Ue(I),Q=c.forwardRef((e,t)=>{const{__scopeSwitch:i,name:o,checked:r,defaultChecked:d,required:u,disabled:l,value:f="on",onCheckedChange:m,form:p,...g}=e,[x,j]=c.useState(null),y=L(t,z=>j(z)),S=c.useRef(!1),P=x?p||!!x.closest("form"):!0,[k,R]=ze({prop:r,defaultProp:d??!1,onChange:m,caller:I});return s.jsxs(Oe,{scope:i,checked:k,disabled:l,children:[s.jsx(Z.button,{type:"button",role:"switch","aria-checked":k,"aria-required":u,"data-state":te(k),"data-disabled":l?"":void 0,disabled:l,value:f,...g,ref:y,onClick:ke(e.onClick,z=>{R($=>!$),P&&(S.current=z.isPropagationStopped(),S.current||z.stopPropagation())})}),P&&s.jsx(se,{control:x,bubbles:!S.current,name:o,value:f,checked:k,required:u,disabled:l,form:p,style:{transform:"translateX(-100%)"}})]})});Q.displayName=I;var Y="SwitchThumb",ee=c.forwardRef((e,t)=>{const{__scopeSwitch:i,...o}=e,r=We(Y,i);return s.jsx(Z.span,{"data-state":te(r.checked),"data-disabled":r.disabled?"":void 0,...o,ref:t})});ee.displayName=Y;var Ve="SwitchBubbleInput",se=c.forwardRef(({__scopeSwitch:e,control:t,checked:i,bubbles:o=!0,...r},d)=>{const u=c.useRef(null),l=L(u,d),f=Re(i),m=$e(t);return c.useEffect(()=>{const p=u.current;if(!p)return;const g=window.HTMLInputElement.prototype,j=Object.getOwnPropertyDescriptor(g,"checked").set;if(f!==i&&j){const y=new Event("click",{bubbles:o});j.call(p,i),p.dispatchEvent(y)}},[f,i,o]),s.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i,...r,tabIndex:-1,ref:l,style:{...r.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});se.displayName=Ve;function te(e){return e?"checked":"unchecked"}var re=Q,Ge=ee;const ne=c.forwardRef(({className:e,...t},i)=>s.jsx(re,{className:q("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:i,children:s.jsx(Ge,{className:q("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));ne.displayName=re.displayName;function fs({product:e,isEdit:t=!1}){var M,U,O,W;const i=((M=e==null?void 0:e.images)==null?void 0:M.map(n=>({id:n.id,url:n.image_url||`/storage/${n.image}`,is_primary:n.is_primary,is_new:!1})))||[],[o,r]=c.useState(i),[d,u]=c.useState([]),[l,f]=c.useState(((O=(U=e==null?void 0:e.images)==null?void 0:U.find(n=>n.is_primary))==null?void 0:O.id)||null),[m,p]=c.useState({name:(e==null?void 0:e.name)||"",slug:(e==null?void 0:e.slug)||"",description:(e==null?void 0:e.description)||"",price:(e==null?void 0:e.price)||0,stock:(e==null?void 0:e.stock)||0,is_active:(e==null?void 0:e.is_active)??!0,sizes:((W=e==null?void 0:e.sizes)==null?void 0:W.map(n=>({id:n.id,size:n.size,stock:n.stock})))||[{size:"",stock:0}],deleted_image_ids:[],primary_image_id:l,new_images:[]}),[g,x]=c.useState({}),[j,y]=c.useState(!1);c.useEffect(()=>{p(n=>({...n,deleted_image_ids:d}))},[d]),c.useEffect(()=>{p(n=>({...n,primary_image_id:l}))},[l]),c.useEffect(()=>{const n=o.filter(a=>a.is_new&&a.file).map(a=>a.file);p(a=>({...a,new_images:n}))},[o]);const S=[{title:"Dasbor",href:"/admin/dashboard"},{title:"Produk",href:"/admin/products"},{title:t?"Edit Produk":"Tambah Produk",href:t?`/admin/products/${e==null?void 0:e.id}/edit`:"/admin/products/create"}],P=n=>{const a=n.target.files;if(!a||a.length===0)return;const v=Array.from(a),b=[];v.forEach(h=>{const w=new FileReader;w.onload=V=>{var G;if((G=V.target)!=null&&G.result){const oe={url:V.target.result,is_primary:o.length===0&&b.length===0,is_new:!0,file:h};r(ce=>[...ce,oe])}},w.readAsDataURL(h)}),n.target.value=""},k=n=>{const a=o[n];a.id&&!a.is_new&&(u(v=>[...v,a.id]),l===a.id&&f(null)),r(v=>v.filter((b,h)=>h!==n))},R=n=>{const a=o[n];r(v=>v.map((b,h)=>({...b,is_primary:h===n}))),a.id&&!a.is_new?f(a.id):f(null)},z=()=>{if(typeof m.name=="string"){const n=m.name.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-");p(a=>({...a,slug:n}))}},$=()=>{p(n=>({...n,sizes:[...n.sizes,{size:"",stock:0}]}))},ie=n=>{p(a=>({...a,sizes:a.sizes.filter((v,b)=>b!==n)}))},B=(n,a,v)=>{p(b=>{const h=[...b.sizes];return h[n]={...h[n],[a]:v},{...b,sizes:h}})},ae=n=>{n.preventDefault(),y(!0);const a=new FormData;a.append("name",m.name),a.append("slug",m.slug),a.append("description",m.description),a.append("price",m.price.toString()),a.append("stock",m.stock.toString()),a.append("is_active",m.is_active?"1":"0"),m.sizes.forEach((h,w)=>{h.id&&a.append(`sizes[${w}][id]`,h.id.toString()),a.append(`sizes[${w}][size]`,h.size),a.append(`sizes[${w}][stock]`,h.stock.toString())}),d.forEach((h,w)=>{a.append(`deleted_image_ids[${w}]`,h.toString())}),l!==null&&a.append("primary_image_id",l.toString()),o.filter(h=>h.is_new&&h.file).map(h=>h.file).forEach((h,w)=>{a.append(`new_images[${w}]`,h)});const b={preserveScroll:!0,preserveState:!0,onSuccess:()=>{y(!1),x({})},onError:h=>{y(!1),x(h)}};t&&(e!=null&&e.id)?(a.append("_method","PUT"),H.post(`/admin/products/${e.id}`,a,b)):H.post("/admin/products",a,b)},E=(n,a)=>{p(v=>({...v,[n]:a}))};return s.jsxs(pe,{breadcrumbs:S,children:[s.jsx(de,{title:t?"Edit Produk":"Tambah Produk"}),s.jsxs("div",{className:"space-y-6 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:t?"Edit Produk":"Tambah Produk"}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(_,{variant:"outline",asChild:!0,children:s.jsxs(ue,{href:"/admin/products",children:[s.jsx(he,{className:"mr-2 h-4 w-4"}),"Kembali ke Produk"]})}),s.jsxs(_,{type:"submit",form:"product-form",children:[s.jsx(ge,{className:"mr-2 h-4 w-4"}),"Simpan Produk"]})]})]}),s.jsx(me,{}),s.jsxs("form",{id:"product-form",onSubmit:ae,className:"space-y-6",children:[s.jsxs(F,{children:[s.jsx(T,{children:s.jsx(A,{children:"Informasi Dasar"})}),s.jsxs(D,{className:"space-y-4",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(C,{htmlFor:"name",children:"Nama Produk"}),s.jsx("div",{className:"space-y-1",children:s.jsx(N,{id:"name",type:"text",value:m.name,onChange:n=>E("name",n.target.value)})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(C,{htmlFor:"slug",children:"Slug"}),s.jsx("div",{className:"space-y-1",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(N,{id:"slug",type:"text",value:m.slug,onChange:n=>E("slug",n.target.value)}),s.jsx(_,{type:"button",variant:"outline",onClick:z,children:"Generate"})]})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(C,{htmlFor:"price",children:"Harga"}),s.jsx("div",{className:"space-y-1",children:s.jsx(N,{id:"price",type:"number",min:"0",value:m.price,onChange:n=>E("price",n.target.value)})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(C,{htmlFor:"stock",children:"Stok"}),s.jsx("div",{className:"space-y-1",children:s.jsx(N,{id:"stock",type:"number",min:"0",value:m.stock,onChange:n=>E("stock",n.target.value)})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(C,{htmlFor:"description",children:"Deskripsi"}),s.jsx("div",{className:"space-y-1",children:s.jsx(fe,{id:"description",value:m.description,onChange:n=>E("description",n.target.value),rows:5})})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ne,{id:"is_active",checked:m.is_active,onCheckedChange:n=>E("is_active",n)}),s.jsx(C,{htmlFor:"is_active",children:"Produk Aktif"})]})]})]}),s.jsxs(F,{children:[s.jsx(T,{children:s.jsx(A,{children:"Gambar Produk"})}),s.jsxs(D,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs(C,{htmlFor:"images",className:"border-border hover:bg-muted flex h-32 w-full cursor-pointer flex-col items-center justify-center gap-1 rounded-lg border-2 border-dashed transition-colors",children:[s.jsx(we,{className:"h-8 w-8"}),s.jsx("span",{className:"text-muted-foreground text-sm",children:"Klik untuk mengunggah gambar"}),s.jsx("span",{className:"text-muted-foreground text-xs",children:"PNG, JPG atau JPEG (maks. 2MB)"})]}),s.jsx(N,{id:"images",type:"file",accept:"image/png,image/jpeg,image/jpg",multiple:!0,className:"hidden",onChange:P})]}),o.length>0&&s.jsx("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-3 lg:grid-cols-4",children:o.map((n,a)=>s.jsxs("div",{className:`group relative aspect-square overflow-hidden rounded-lg border ${n.is_primary?"ring-primary ring-2":""}`,children:[s.jsx("img",{src:n.url,alt:"",className:"h-full w-full object-cover"}),s.jsxs("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center gap-2 opacity-0 transition-opacity group-hover:opacity-100",children:[s.jsx(_,{type:"button",variant:"secondary",size:"icon",onClick:()=>R(a),disabled:n.is_primary,children:s.jsx(je,{className:n.is_primary?"fill-primary":""})}),s.jsx(_,{type:"button",variant:"destructive",size:"icon",onClick:()=>k(a),children:s.jsx(xe,{className:"h-4 w-4"})})]})]},a))})]})]}),s.jsxs(F,{children:[s.jsxs(T,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[s.jsx(A,{children:"Ukuran yang Tersedia"}),s.jsxs(_,{type:"button",variant:"outline",size:"sm",onClick:$,children:[s.jsx(ve,{className:"mr-1 h-4 w-4"}),"Tambah Ukuran"]})]}),s.jsx(D,{className:"space-y-4",children:m.sizes.map((n,a)=>s.jsxs("div",{className:"flex items-end gap-4",children:[s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx(C,{htmlFor:`size-${a}`,children:"Ukuran"}),s.jsx(N,{id:`size-${a}`,type:"text",value:n.size,onChange:v=>B(a,"size",v.target.value)})]}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx(C,{htmlFor:`stock-${a}`,children:"Stok"}),s.jsx(N,{id:`stock-${a}`,type:"number",min:"0",value:n.stock,onChange:v=>B(a,"stock",v.target.value)})]}),s.jsx(_,{type:"button",variant:"outline",size:"icon",onClick:()=>ie(a),disabled:m.sizes.length===1,children:s.jsx(ye,{className:"h-4 w-4"})})]},a))})]})]})]})]})}export{fs as default};
